2025-10-27 16:46:23,896	INFO worker.py:2013 -- Started a local Ray instance.
/home/boobus/projects/factor_momentum/.venv/lib/python3.11/site-packages/ray/_private/worker.py:2052: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
Traceback (most recent call last):
  File "/home/boobus/projects/factor_momentum/backtest.py", line 38, in <module>
    main()
  File "/home/boobus/projects/factor_momentum/backtest.py", line 27, in main
    weights = sfb.backtest_parallel(
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/boobus/projects/factor_momentum/.venv/lib/python3.11/site-packages/sf_quant/backtester/parallel.py", line 166, in backtest_parallel
    portfolio_list = ray.get(portfolio_futures)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/boobus/projects/factor_momentum/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/boobus/projects/factor_momentum/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/boobus/projects/factor_momentum/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2962, in get
    values, debugger_breakpoint = worker.get_objects(
                                  ^^^^^^^^^^^^^^^^^^^
  File "/home/boobus/projects/factor_momentum/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 1026, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ValueError): [36mray::_construct_portfolio()[39m (pid=3873850, ip=192.168.217.150)
  File "/home/boobus/projects/factor_momentum/.venv/lib/python3.11/site-packages/sf_quant/backtester/parallel.py", line 30, in _construct_portfolio
    construct_covariance_matrix(date_, barrids).drop("barrid").to_numpy()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/boobus/projects/factor_momentum/.venv/lib/python3.11/site-packages/sf_quant/data/covariance_matrix.py", line 66, in construct_covariance_matrix
    _construct_factor_covariance_matrix(date_).drop("factor_1").to_numpy()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/boobus/projects/factor_momentum/.venv/lib/python3.11/site-packages/sf_quant/data/covariance_matrix.py", line 119, in _construct_factor_covariance_matrix
    cov_mat = np.where(np.isnan(utm), utm.T, utm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: operands could not be broadcast together with shapes (0,76) (76,0) (0,76)
